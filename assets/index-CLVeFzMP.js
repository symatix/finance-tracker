import{g as fe,y as ye,r as d,Q as Le,U as Pe,z as se,f as le,j as e,D as K,b as je,E as Ee,V as Ce,x as ce,h as ze,W as Be,c as _e,G as Ne,X as ue,Y as Q,l as be,m as we,K as ve,B as $,T as k,L as M,w as F,H as E,F as ae,I as ne,S as re,M as V,J as O,Z as me,_ as pe,$ as he,a0 as xe,C as Fe,n as De}from"./index-DpbbXsWZ.js";import{S as U}from"./shoppingListOperations-Dx_yx3XL.js";import{C as Ie,A as de}from"./Close-lqoz1D_a.js";import{D as Y}from"./Divider-BZDYSeNq.js";import{S as Me}from"./Save-CQ5iPj4O.js";import{C as Re}from"./Cancel-DF3khkzZ.js";import{E as oe,D as ie,a as Ae,b as $e,c as Oe,d as Te}from"./Edit-DkKO4Sa_.js";import{A as We,a as qe,E as Qe,b as Ge}from"./ExpandMore-BHLTgYSV.js";function Ue(a){return fe("PrivateSwitchBase",a)}ye("PrivateSwitchBase",["root","checked","disabled","input","edgeStart","edgeEnd"]);const Ve=a=>{const{classes:t,checked:n,disabled:o,edge:l}=a,m={root:["root",n&&"checked",o&&"disabled",l&&`edge${K(l)}`],input:["input"]};return je(m,Ue,t)},He=le(Ee,{name:"MuiSwitchBase"})({padding:9,borderRadius:"50%",variants:[{props:{edge:"start",size:"small"},style:{marginLeft:-3}},{props:({edge:a,ownerState:t})=>a==="start"&&t.size!=="small",style:{marginLeft:-12}},{props:{edge:"end",size:"small"},style:{marginRight:-3}},{props:({edge:a,ownerState:t})=>a==="end"&&t.size!=="small",style:{marginRight:-12}}]}),Ke=le("input",{name:"MuiSwitchBase",shouldForwardProp:Ce})({cursor:"inherit",position:"absolute",opacity:0,width:"100%",height:"100%",top:0,left:0,margin:0,padding:0,zIndex:1}),Je=d.forwardRef(function(t,n){const{autoFocus:o,checked:l,checkedIcon:m,defaultChecked:h,disabled:x,disableFocusRipple:g=!1,edge:y=!1,icon:p,id:r,inputProps:c,inputRef:C,name:b,onBlur:z,onChange:S,onFocus:L,readOnly:j,required:B=!1,tabIndex:f,type:P,value:w,slots:T={},slotProps:_={},...u}=t,[N,v]=Le({controlled:l,default:!!h,name:"SwitchBase",state:"checked"}),s=Pe(),J=I=>{L&&L(I),s&&s.onFocus&&s.onFocus(I)},Z=I=>{z&&z(I),s&&s.onBlur&&s.onBlur(I)},X=I=>{if(I.nativeEvent.defaultPrevented)return;const A=I.target.checked;v(A),S&&S(I,A)};let W=x;s&&typeof W>"u"&&(W=s.disabled);const ee=P==="checkbox"||P==="radio",H={...t,checked:N,disabled:W,disableFocusRipple:g,edge:y},q=Ve(H),i={slots:T,slotProps:{input:c,..._}},[R,D]=se("root",{ref:n,elementType:He,className:q.root,shouldForwardComponentProp:!0,externalForwardedProps:{...i,component:"span",...u},getSlotProps:I=>({...I,onFocus:A=>{I.onFocus?.(A),J(A)},onBlur:A=>{I.onBlur?.(A),Z(A)}}),ownerState:H,additionalProps:{centerRipple:!0,focusRipple:!g,disabled:W,role:void 0,tabIndex:null}}),[Se,ke]=se("input",{ref:C,elementType:Ke,className:q.input,externalForwardedProps:i,getSlotProps:I=>({...I,onChange:A=>{I.onChange?.(A),X(A)}}),ownerState:H,additionalProps:{autoFocus:o,checked:l,defaultChecked:h,disabled:W,id:ee?r:void 0,name:b,readOnly:j,required:B,tabIndex:f,type:P,...P==="checkbox"&&w===void 0?{}:{value:w}}});return e.jsxs(R,{...D,children:[e.jsx(Se,{...ke}),N?m:p]})}),Xe=ce(e.jsx("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"})),Ye=ce(e.jsx("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"})),Ze=ce(e.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}));function et(a){return fe("MuiCheckbox",a)}const te=ye("MuiCheckbox",["root","checked","disabled","indeterminate","colorPrimary","colorSecondary","sizeSmall","sizeMedium"]),tt=a=>{const{classes:t,indeterminate:n,color:o,size:l}=a,m={root:["root",n&&"indeterminate",`color${K(o)}`,`size${K(l)}`]},h=je(m,et,t);return{...t,...h}},st=le(Je,{shouldForwardProp:a=>Ce(a)||a==="classes",name:"MuiCheckbox",slot:"Root",overridesResolver:(a,t)=>{const{ownerState:n}=a;return[t.root,n.indeterminate&&t.indeterminate,t[`size${K(n.size)}`],n.color!=="default"&&t[`color${K(n.color)}`]]}})(Ne(({theme:a})=>({color:(a.vars||a).palette.text.secondary,variants:[{props:{color:"default",disableRipple:!1},style:{"&:hover":{backgroundColor:a.alpha((a.vars||a).palette.action.active,(a.vars||a).palette.action.hoverOpacity)}}},...Object.entries(a.palette).filter(ue()).map(([t])=>({props:{color:t,disableRipple:!1},style:{"&:hover":{backgroundColor:a.alpha((a.vars||a).palette[t].main,(a.vars||a).palette.action.hoverOpacity)}}})),...Object.entries(a.palette).filter(ue()).map(([t])=>({props:{color:t},style:{[`&.${te.checked}, &.${te.indeterminate}`]:{color:(a.vars||a).palette[t].main},[`&.${te.disabled}`]:{color:(a.vars||a).palette.action.disabled}}})),{props:{disableRipple:!1},style:{"&:hover":{"@media (hover: none)":{backgroundColor:"transparent"}}}}]}))),at=e.jsx(Ye,{}),nt=e.jsx(Xe,{}),rt=e.jsx(Ze,{}),ge=d.forwardRef(function(t,n){const o=ze({props:t,name:"MuiCheckbox"}),{checkedIcon:l=at,color:m="primary",icon:h=nt,indeterminate:x=!1,indeterminateIcon:g=rt,inputProps:y,size:p="medium",disableRipple:r=!1,className:c,slots:C={},slotProps:b={},...z}=o,S=x?g:h,L=x?g:l,j={...o,disableRipple:r,color:m,indeterminate:x,size:p},B=tt(j),f=b.input??y,[P,w]=se("root",{ref:n,elementType:st,className:_e(B.root,c),shouldForwardComponentProp:!0,externalForwardedProps:{slots:C,slotProps:b,...z},ownerState:j,additionalProps:{type:"checkbox",icon:d.cloneElement(S,{fontSize:S.props.fontSize??p}),checkedIcon:d.cloneElement(L,{fontSize:L.props.fontSize??p}),disableRipple:r,slots:C,slotProps:{input:Be(typeof f=="function"?f(j):f,{"data-indeterminate":x})}}});return e.jsx(P,{...w,classes:B})});class G{static async create(t){const n=new Date().toISOString(),{data:o,error:l}=await Q.from("list_items").insert({...t,created_at:n,updated_at:n}).select().single();if(l)throw l;return o}static async findByListId(t){const{data:n,error:o}=await Q.from("list_items").select("*").eq("list_id",t).order("created_at",{ascending:!0});if(o)throw o;return n||[]}static async findById(t){const{data:n,error:o}=await Q.from("list_items").select("*").eq("id",t).single();if(o){if(o.code==="PGRST116")return null;throw o}return n}static async update(t,n){const{data:o,error:l}=await Q.from("list_items").update({...n,updated_at:new Date().toISOString()}).eq("id",t).select().single();if(l){if(l.code==="PGRST116")return null;throw l}return o}static async delete(t){const{error:n}=await Q.from("list_items").delete().eq("id",t);if(n)throw n;return!0}static async toggleChecked(t){const n=await this.findById(t);return n?this.update(t,{checked:!n.checked}):null}static async isListComplete(t){const n=await this.findByListId(t);return n.length>0&&n.every(o=>o.checked)}static async bulkUpdate(t,n){const{data:o,error:l}=await Q.from("list_items").update({...n,updated_at:new Date().toISOString()}).in("id",t).select();if(l)throw l;return o||[]}}function ot(a="active"){const{user:t}=be(),[n,o]=d.useState([]),[l,m]=d.useState(!0),h=d.useCallback(async()=>{if(t)try{const p=await U.findWithCategoryDetails(t.id,a);o(p)}catch(p){console.error("Error fetching shopping lists:",p)}finally{m(!1)}},[t,a]);return d.useEffect(()=>{h()},[h]),{shoppingLists:n,loading:l,createList:async p=>{if(t)try{const{items:r,...c}=p;r&&r.length>0?await U.createWithItems({...c,user_id:t.id},r):await U.create({...c,user_id:t.id}),await h()}catch(r){throw console.error("Error creating shopping list:",r),r}},updateList:async(p,r)=>{if(t)try{await U.update(p,r,t.id),await h()}catch(c){throw console.error("Error updating shopping list:",c),c}},deleteList:async p=>{if(t)try{await U.delete(p,t.id),await h()}catch(r){throw console.error("Error deleting shopping list:",r),r}},refetch:h}}function it({open:a,onClose:t,onSubmit:n,editingList:o}){const{categories:l}=we(),[m,h]=d.useState(""),[x,g]=d.useState(""),[y,p]=d.useState(""),[r,c]=d.useState([]),[C,b]=d.useState(""),[z,S]=d.useState(1),[L,j]=d.useState(""),[B,f]=d.useState(null),[P,w]=d.useState(""),[T,_]=d.useState(1),[u,N]=d.useState("");d.useEffect(()=>{o?(h(o.name||""),g(o.category_id||""),p(o.subcategory||""),c([])):(h(""),g(""),p(""),c([])),b(""),S(1),j(""),f(null),w(""),_(1),N("")},[o,a]);const s=l.find(i=>i.id===x)?.subcategories||[],J=()=>{if(!C.trim())return;const i={name:C.trim(),quantity:z,estimated_price:L?Number(L):void 0};c([...r,i]),b(""),S(1),j("")},Z=i=>{const R=r[i];f(i),w(R.name),_(R.quantity),N(R.estimated_price?.toString()||"")},X=()=>{if(B===null||!P.trim())return;const i=[...r];i[B]={name:P.trim(),quantity:T,estimated_price:u?Number(u):void 0},c(i),f(null),w(""),_(1),N("")},W=()=>{f(null),w(""),_(1),N("")},ee=i=>{c(r.filter((R,D)=>D!==i))},H=()=>{!m.trim()||!x||n({name:m.trim(),category_id:x,subcategory:y||void 0,items:r})},q=()=>{h(""),g(""),p(""),c([]),b(""),S(1),j(""),f(null),w(""),_(1),N(""),t()};return e.jsx(ve,{open:a,onClose:q,anchor:"right",PaperProps:{sx:{width:{xs:"100%",sm:400},borderLeft:"1px solid",borderColor:"divider",backgroundColor:"#000000"}},children:e.jsxs($,{sx:{p:3,height:"100%",display:"flex",flexDirection:"column",backgroundColor:"#1a1a1a"},children:[e.jsxs($,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:3},children:[e.jsx(k,{variant:"h6",sx:{fontWeight:600},children:o?"Edit Shopping List":"Create Shopping List"}),e.jsx(M,{onClick:q,size:"small",children:e.jsx(Ie,{})})]}),e.jsx(Y,{sx:{mb:3}}),e.jsxs(F,{spacing:3,sx:{flexGrow:1,overflow:"visible"},children:[e.jsx(E,{label:"List Name",value:m,onChange:i=>h(i.target.value),fullWidth:!0,autoFocus:!0}),e.jsxs(ae,{fullWidth:!0,children:[e.jsx(ne,{children:"Category"}),e.jsx(re,{value:x,label:"Category",onChange:i=>g(i.target.value),children:l.map(i=>e.jsxs(V,{value:i.id,children:[i.name," (",i.type,")"]},i.id))})]}),s.length>0&&e.jsxs(ae,{fullWidth:!0,children:[e.jsx(ne,{children:"Subcategory (optional)"}),e.jsxs(re,{value:y,label:"Subcategory (optional)",onChange:i=>p(i.target.value),children:[e.jsx(V,{value:"",children:e.jsx("em",{children:"None"})}),s.map(i=>e.jsx(V,{value:i,children:i},i))]})]}),e.jsxs($,{children:[e.jsx(k,{variant:"h6",gutterBottom:!0,children:"Items"}),e.jsxs(F,{direction:"row",spacing:1,alignItems:"center",mb:2,children:[e.jsx(E,{size:"small",placeholder:"Item name",value:C,onChange:i=>b(i.target.value),onKeyDown:i=>{i.key==="Enter"&&(i.preventDefault(),J())},sx:{flexGrow:1}}),e.jsx(E,{size:"small",type:"number",placeholder:"Qty",value:z,onChange:i=>S(Number(i.target.value)||1),inputProps:{min:1},sx:{width:80}}),e.jsx(E,{size:"small",type:"number",placeholder:"Est. price",value:L,onChange:i=>j(i.target.value),inputProps:{min:0,step:.01},sx:{width:100}}),e.jsx(M,{color:"primary",onClick:J,disabled:!C.trim(),children:e.jsx(de,{})})]}),e.jsxs(F,{spacing:1,children:[r.map((i,R)=>e.jsx($,{display:"flex",alignItems:"center",gap:1,children:B===R?e.jsxs(e.Fragment,{children:[e.jsx(E,{size:"small",value:P,onChange:D=>w(D.target.value),onKeyDown:D=>{D.key==="Enter"&&(D.preventDefault(),X())},sx:{flexGrow:1}}),e.jsx(E,{size:"small",type:"number",value:T,onChange:D=>_(Number(D.target.value)||1),inputProps:{min:1},sx:{width:80}}),e.jsx(E,{size:"small",type:"number",value:u,onChange:D=>N(D.target.value),inputProps:{min:0,step:.01},sx:{width:100}}),e.jsx(M,{color:"primary",size:"small",onClick:X,children:e.jsx(Me,{})}),e.jsx(M,{size:"small",onClick:W,children:e.jsx(Re,{})})]}):e.jsxs(e.Fragment,{children:[e.jsx($,{sx:{flexGrow:1,p:1,border:"1px solid",borderColor:"divider",borderRadius:1,display:"flex",alignItems:"center"},children:e.jsxs(k,{variant:"body2",children:[i.name," (Qty: ",i.quantity,i.estimated_price?`, Est: $${i.estimated_price}`:"",")"]})}),e.jsx(M,{size:"small",onClick:()=>Z(R),children:e.jsx(oe,{})}),e.jsx(M,{size:"small",color:"error",onClick:()=>ee(R),children:e.jsx(ie,{})})]})},R)),r.length===0&&e.jsx(k,{variant:"body2",color:"text.secondary",style:{fontStyle:"italic"},children:"No items added yet"})]})]})]}),e.jsx($,{sx:{mt:3,pt:2,borderTop:"1px solid",borderColor:"divider"},children:e.jsxs(F,{direction:"row",spacing:2,justifyContent:"flex-end",children:[e.jsx(O,{onClick:q,children:"Cancel"}),e.jsx(O,{onClick:H,variant:"contained",disabled:!m.trim()||!x,children:o?"Update":"Create"})]})})]})})}function lt(a){const[t,n]=d.useState([]),[o,l]=d.useState(!1),m=d.useCallback(async()=>{if(!a){n([]);return}l(!0);try{const r=await G.findByListId(a);n(r)}catch(r){console.error("Error fetching list items:",r)}finally{l(!1)}},[a]);return d.useEffect(()=>{m()},[m]),{items:t,loading:o,createItem:async r=>{try{await G.create(r),await m()}catch(c){throw console.error("Error creating list item:",c),c}},updateItem:async(r,c)=>{try{await G.update(r,c),await m()}catch(C){throw console.error("Error updating list item:",C),C}},deleteItem:async r=>{try{await G.delete(r),await m()}catch(c){throw console.error("Error deleting list item:",c),c}},toggleItemChecked:async r=>{try{await G.toggleChecked(r),await m()}catch(c){throw console.error("Error toggling item checked:",c),c}},isListComplete:async()=>{if(!a)return!1;try{return await G.isListComplete(a)}catch(r){return console.error("Error checking if list is complete:",r),!1}},refetch:m}}function ct({open:a,onClose:t,onSubmit:n,editingItem:o}){const[l,m]=d.useState(""),[h,x]=d.useState(1),[g,y]=d.useState();d.useEffect(()=>{o?(m(o.name||""),x(o.quantity||1),y(o.estimated_price||void 0)):(m(""),x(1),y(void 0))},[o,a]);const p=()=>{l.trim()&&n({name:l.trim(),quantity:h,estimated_price:g})},r=()=>{m(""),x(1),y(void 0),t()};return e.jsxs(Ae,{open:a,onClose:r,maxWidth:"sm",fullWidth:!0,children:[e.jsx($e,{children:o?"Edit Item":"Add Item"}),e.jsxs(Oe,{children:[e.jsx(E,{autoFocus:!0,margin:"dense",label:"Item Name",fullWidth:!0,variant:"outlined",value:l,onChange:c=>m(c.target.value),sx:{mb:2}}),e.jsx(E,{margin:"dense",label:"Quantity",type:"number",fullWidth:!0,variant:"outlined",value:h,onChange:c=>x(Number(c.target.value)),sx:{mb:2},inputProps:{min:1}}),e.jsx(E,{margin:"dense",label:"Estimated Price (optional)",type:"number",fullWidth:!0,variant:"outlined",value:g||"",onChange:c=>y(c.target.value?Number(c.target.value):void 0),inputProps:{min:0,step:.01}})]}),e.jsxs(Te,{children:[e.jsx(O,{onClick:r,children:"Cancel"}),e.jsx(O,{onClick:p,variant:"contained",disabled:!l.trim(),children:o?"Update":"Add"})]})]})}function dt({open:a,onClose:t,list:n,onCompleteList:o}){const{items:l,loading:m,createItem:h,updateItem:x,deleteItem:g,toggleItemChecked:y}=lt(n?.id||null),[p,r]=d.useState(!1),[c,C]=d.useState(null),[b,z]=d.useState(""),[S,L]=d.useState(1),[j,B]=d.useState(""),[f,P]=d.useState(0),w=()=>{if(!b.trim())return;const s={name:b.trim(),quantity:S,estimated_price:j?Number(j):void 0};n&&h({...s,list_id:n.id}),z(""),L(1),B("")},T=s=>{C(s),r(!0)},_=async s=>{confirm("Delete this item?")&&await g(s)},u=async s=>{c?await x(c.id,s):n&&await h({...s,list_id:n.id}),r(!1)},N=()=>{n&&f>0&&(o(n.id,f),t())},v=l.length>0&&l.every(s=>s.checked);return e.jsxs(ve,{open:a,onClose:t,anchor:"right",PaperProps:{sx:{width:{xs:"100%",sm:500},borderLeft:"1px solid",borderColor:"divider",backgroundColor:"#000000"}},children:[e.jsxs($,{sx:{p:3,height:"100%",display:"flex",flexDirection:"column",backgroundColor:"#1a1a1a"},children:[e.jsxs($,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:3},children:[e.jsx(k,{variant:"h6",sx:{fontWeight:600},children:n?.name}),e.jsx(M,{onClick:t,size:"small",children:e.jsx(Ie,{})})]}),e.jsx(Y,{sx:{mb:3}}),e.jsxs(F,{spacing:3,sx:{flexGrow:1,overflow:"visible"},children:[e.jsx(F,{direction:"row",justifyContent:"space-between",alignItems:"center",children:e.jsx(k,{variant:"h6",children:"Items"})}),e.jsxs(F,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(E,{size:"small",placeholder:"Item name",value:b,onChange:s=>z(s.target.value),onKeyDown:s=>{s.key==="Enter"&&(s.preventDefault(),w())},sx:{flexGrow:1}}),e.jsx(E,{size:"small",type:"number",placeholder:"Qty",value:S,onChange:s=>L(Number(s.target.value)||1),inputProps:{min:1},sx:{width:80}}),e.jsx(E,{size:"small",type:"number",placeholder:"Est. price",value:j,onChange:s=>B(s.target.value),inputProps:{min:0,step:.01},sx:{width:100}}),e.jsx(M,{color:"primary",onClick:w,disabled:!b.trim(),children:e.jsx(de,{})})]}),m?e.jsx(k,{children:"Loading items..."}):l.length===0?e.jsx(k,{children:"No items yet. Add some!"}):e.jsxs(F,{spacing:2,sx:{flexGrow:1,overflow:"auto"},children:[e.jsx(me,{children:l.filter(s=>!s.checked).map(s=>e.jsxs(pe,{divider:!0,children:[e.jsx(ge,{checked:s.checked,onChange:()=>y(s.id)}),e.jsx(he,{primary:s.name,secondary:`Qty: ${s.quantity}${s.estimated_price?` | Est: $${s.estimated_price}`:""}`}),e.jsxs(xe,{children:[e.jsx(M,{onClick:()=>T(s),size:"small",children:e.jsx(oe,{})}),e.jsx(M,{onClick:()=>_(s.id),color:"error",size:"small",children:e.jsx(ie,{})})]})]},s.id))}),l.some(s=>s.checked)&&e.jsxs(We,{sx:{backgroundColor:"#2a2a2a","& .MuiAccordionSummary-root":{backgroundColor:"#2a2a2a"},"& .MuiAccordionDetails-root":{backgroundColor:"#1a1a1a"}},children:[e.jsx(qe,{expandIcon:e.jsx(Qe,{}),children:e.jsxs(k,{variant:"subtitle1",children:["Completed Items (",l.filter(s=>s.checked).length,")"]})}),e.jsx(Ge,{sx:{p:0},children:e.jsx(me,{children:l.filter(s=>s.checked).map(s=>e.jsxs(pe,{divider:!0,sx:{opacity:.6},children:[e.jsx(ge,{checked:s.checked,onChange:()=>y(s.id)}),e.jsx(he,{primary:s.name,secondary:`Qty: ${s.quantity}${s.estimated_price?` | Est: $${s.estimated_price}`:""}`,sx:{textDecoration:"line-through"}}),e.jsxs(xe,{children:[e.jsx(M,{onClick:()=>T(s),size:"small",children:e.jsx(oe,{})}),e.jsx(M,{onClick:()=>_(s.id),color:"error",size:"small",children:e.jsx(ie,{})})]})]},s.id))})})]})]}),v&&e.jsxs(e.Fragment,{children:[e.jsx(Y,{}),e.jsx(k,{variant:"h6",gutterBottom:!0,children:"List Complete!"}),e.jsx(E,{label:"Total Amount Spent",type:"number",fullWidth:!0,value:f,onChange:s=>P(Number(s.target.value)),inputProps:{min:0,step:.01}})]})]}),e.jsx($,{sx:{mt:3,pt:2,borderTop:"1px solid",borderColor:"divider"},children:e.jsxs(F,{direction:"row",spacing:2,justifyContent:"flex-end",children:[e.jsx(O,{onClick:t,children:"Close"}),v&&e.jsx(O,{onClick:N,variant:"contained",disabled:f<=0,children:"Complete List"})]})})]}),e.jsx(ct,{open:p,onClose:()=>r(!1),onSubmit:u,editingItem:c})]})}function jt(){const{user:a}=be(),[t,n]=d.useState("active"),{shoppingLists:o,loading:l,createList:m,updateList:h,deleteList:x,refetch:g}=ot(t),[y,p]=d.useState(!1),[r,c]=d.useState(void 0),C=()=>{c(void 0),p(!0)},b=u=>{c(u),p(!0)},z=()=>{p(!1),c(void 0)},S=async u=>{r?await h(r.id,{name:u.name,category_id:u.category_id,subcategory:u.subcategory}):await m(u),z()},[L,j]=d.useState(!1),[B,f]=d.useState(null),P=u=>{f(u),j(!0)},w=()=>{j(!1),f(null)},T=async u=>{confirm("Are you sure you want to delete this shopping list?")&&await x(u)},_=async(u,N)=>{if(a)try{const v=await U.completeList(u,N,a.id);v&&we.setState(s=>({transactions:[...s.transactions,{id:v.transaction.id,type:v.transaction.type,amount:v.transaction.amount,categoryId:v.transaction.category_id,subcategory:v.transaction.subcategory,note:v.transaction.note,date:v.transaction.date}]})),await g()}catch(v){console.error("Error completing list:",v),alert("Failed to complete list. Please try again.")}};return a?e.jsxs($,{p:4,children:[e.jsxs(F,{direction:{xs:"column",sm:"row"},justifyContent:{xs:"flex-start",sm:"space-between"},alignItems:{xs:"flex-start",sm:"center"},mb:1,spacing:2,children:[e.jsx(k,{variant:"h5",children:"Shopping Lists"}),e.jsxs(F,{direction:{xs:"column",sm:"row"},spacing:2,alignItems:"center",width:{xs:"100%",sm:"auto"},children:[e.jsxs(ae,{size:"small",sx:{minWidth:120,width:{xs:"100%",sm:"auto"}},children:[e.jsx(ne,{children:"Filter"}),e.jsxs(re,{value:t,label:"Filter",onChange:u=>n(u.target.value),children:[e.jsx(V,{value:"active",children:"Active"}),e.jsx(V,{value:"completed",children:"Completed"}),e.jsx(V,{value:"all",children:"All"})]})]}),e.jsx(O,{variant:"contained",startIcon:e.jsx(de,{}),onClick:C,sx:{width:{xs:"100%",sm:"auto"}},children:"New List"})]})]}),e.jsx(Y,{sx:{mb:3}}),l?e.jsx(k,{children:"Loading..."}):e.jsx(F,{spacing:2,children:o.map(u=>e.jsx(Fe,{sx:{opacity:u.status==="completed"?.7:1},children:e.jsxs(De,{children:[e.jsx(k,{variant:"h6",children:u.name}),e.jsxs(k,{variant:"body2",color:"text.secondary",children:["Category: ",u.categoryName," ",u.subcategory&&` - ${u.subcategory}`]}),e.jsxs(k,{variant:"body2",color:"text.secondary",children:["Status: ",u.status==="active"?"Active":"Completed"]}),e.jsxs(F,{direction:"row",spacing:1,mt:2,children:[e.jsx(O,{size:"small",onClick:()=>P(u),children:"Open"}),e.jsx(O,{size:"small",onClick:()=>b(u),children:"Edit"}),e.jsx(O,{size:"small",color:"error",onClick:()=>T(u.id),children:"Delete"})]})]})},u.id))}),e.jsx(it,{open:y,onClose:z,onSubmit:S,editingList:r}),e.jsx(dt,{open:L,onClose:w,list:B,onCompleteList:_})]}):null}export{jt as default};
